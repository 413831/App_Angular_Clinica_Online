!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/fire"),require("@angular/common")):"function"==typeof define&&define.amd?define("@angular/fire/performance",["exports","@angular/core","rxjs","rxjs/operators","@angular/fire","@angular/common"],n):n(((e=e||self).angular=e.angular||{},e.angular.fire=e.angular.fire||{},e.angular.fire.performance={}),e.ng.core,e.rxjs,e.rxjs.operators,e.angular.fire,e.ng.common)}(this,(function(e,n,r,t,i,o){"use strict";var u=new n.InjectionToken("angularfire2.performance.auto_trace"),a=new n.InjectionToken("angularfire2.performance.instrumentationEnabled"),c=new n.InjectionToken("angularfire2.performance.dataCollectionEnabled"),s=function(){function e(e,n,u,a,c){return this.zone=a,this.performance=r.of(void 0).pipe(t.switchMap((function(){return o.isPlatformBrowser(c)?a.runOutsideAngular((function(){return import("firebase/performance")})):r.empty()})),t.map((function(){return a.runOutsideAngular((function(){return e.performance()}))})),t.tap((function(e){0==n&&(e.instrumentationEnabled=!1),0==u&&(e.dataCollectionEnabled=!1)})),t.shareReplay({bufferSize:1,refCount:!1})),i["ɵlazySDKProxy"](this,this.performance,a)}return e.decorators=[{type:n.Injectable,args:[{providedIn:"any"}]}],e.ctorParameters=function(){return[{type:i.FirebaseApp},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[a]}]},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[c]}]},{type:n.NgZone},{type:Object,decorators:[{type:n.Inject,args:[n.PLATFORM_ID]}]}]},e.ɵprov=n["ɵɵdefineInjectable"]({factory:function(){return new e(n["ɵɵinject"](i.FirebaseApp),n["ɵɵinject"](a,8),n["ɵɵinject"](c,8),n["ɵɵinject"](n.NgZone),n["ɵɵinject"](n.PLATFORM_ID))},token:e,providedIn:"any"}),e}();var f=function(e){if("undefined"!=typeof window&&window.performance){var n=window.performance.getEntriesByName(e,"measure")||[],t="_"+e+"Start["+n.length+"]",i="_"+e+"End["+n.length+"]";return new r.Observable((function(n){return window.performance.mark(t),n.next(),{unsubscribe:function(){window.performance.mark(i),window.performance.measure(e,t,i)}}}))}return r.empty()};var p=!("undefined"==typeof window||!window.performance||(window.performance.mark("_isStableStart"),0)),b=function(){function e(e){p&&(this.disposable=e.isStable.pipe(t.first((function(e){return e})),t.tap((function(){window.performance.mark("_isStableEnd"),window.performance.measure("isStable","_isStableStart","_isStableEnd")}))).subscribe())}return e.prototype.ngOnDestroy=function(){this.disposable&&this.disposable.unsubscribe()},e.decorators=[{type:n.Injectable,args:[{providedIn:"any"}]}],e.ctorParameters=function(){return[{type:n.ApplicationRef}]},e.ɵprov=n["ɵɵdefineInjectable"]({factory:function(){return new e(n["ɵɵinject"](n.ApplicationRef))},token:e,providedIn:"any"}),e}();var l=function(){function e(e,n){e.dataCollectionEnabled}return e.decorators=[{type:n.NgModule,args:[{providers:[s]}]}],e.ctorParameters=function(){return[{type:s},{type:b,decorators:[{type:n.Optional}]}]},e}();e.AUTOMATICALLY_TRACE_CORE_NG_METRICS=u,e.AngularFirePerformance=s,e.AngularFirePerformanceModule=l,e.DATA_COLLECTION_ENABLED=c,e.INSTRUMENTATION_ENABLED=a,e.PerformanceMonitoringService=b,e.trace=function(e){return function(n){return new r.Observable((function(r){var i=f(e).subscribe();return n.pipe(t.tap((function(){return i.unsubscribe()}),(function(){}),(function(){return i.unsubscribe()}))).subscribe(r)}))}},e.traceUntil=function(e,n,i){return function(o){return new r.Observable((function(r){var u=f(e).subscribe();return o.pipe(t.tap((function(e){return n(e)&&u.unsubscribe()}),(function(){}),(function(){return i&&i.orComplete&&u.unsubscribe()}))).subscribe(r)}))}},e.traceUntilComplete=function(e){return function(n){return new r.Observable((function(r){var i=f(e).subscribe();return n.pipe(t.tap((function(){}),(function(){}),(function(){return i.unsubscribe()}))).subscribe(r)}))}},e.traceUntilFirst=function(e){return function(n){return new r.Observable((function(r){var i=f(e).subscribe();return n.pipe(t.tap((function(){return i.unsubscribe()}),(function(){}),(function(){}))).subscribe(r)}))}},e.traceWhile=function(e,n,i){return function(o){return new r.Observable((function(r){var u;return o.pipe(t.tap((function(r){n(r)?u=u||f(e).subscribe():(u&&u.unsubscribe(),u=void 0)}),(function(){}),(function(){return i&&i.orComplete&&u&&u.unsubscribe()}))).subscribe(r)}))}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-fire-performance.umd.min.js.map