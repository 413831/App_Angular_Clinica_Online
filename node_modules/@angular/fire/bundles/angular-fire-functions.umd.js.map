{"version":3,"file":"angular-fire-functions.umd.js","sources":["ng://@angular/fire/functions/functions.ts","ng://@angular/fire/functions/functions.module.ts"],"sourcesContent":["import { Injectable, Inject, Optional, NgZone, InjectionToken } from '@angular/core';\nimport { of, from, Observable } from 'rxjs';\nimport { map, switchMap, shareReplay, tap, observeOn } from 'rxjs/operators';\nimport { FirebaseOptions, FirebaseAppConfig, FIREBASE_APP_NAME, ɵlazySDKProxy, ɵPromiseProxy, ɵAngularFireSchedulers } from '@angular/fire';\nimport { FIREBASE_OPTIONS, ɵfirebaseAppFactory } from '@angular/fire';\nimport { functions } from 'firebase/app';\n\nexport const ORIGIN = new InjectionToken<string>('angularfire2.functions.origin');\nexport const REGION = new InjectionToken<string>('angularfire2.functions.region');\n\n// override httpsCallable for compatibility with 5.x\nexport interface AngularFireFunctions extends Omit<ɵPromiseProxy<functions.Functions>, 'httpsCallable'> { };\n\n@Injectable({\n  providedIn: 'any'\n})\nexport class AngularFireFunctions {\n\n  public readonly httpsCallable: <T=any, R=any>(name: string) => (data: T) => Observable<R>\n\n  constructor(\n    @Inject(FIREBASE_OPTIONS) options:FirebaseOptions,\n    @Optional() @Inject(FIREBASE_APP_NAME) nameOrConfig:string|FirebaseAppConfig|null|undefined,\n    zone: NgZone,\n    @Optional() @Inject(REGION) region:string|null,\n    @Optional() @Inject(ORIGIN) origin:string|null\n  ) {\n    const schedulers = new ɵAngularFireSchedulers(zone);\n\n    const functions = of(undefined).pipe(\n      observeOn(schedulers.outsideAngular),\n      switchMap(() => import('firebase/functions')),\n      map(() => ɵfirebaseAppFactory(options, zone, nameOrConfig)),\n      map(app => app.functions(region || undefined)),\n      tap(functions => {\n        if (origin) { functions.useFunctionsEmulator(origin) }\n      }),\n      shareReplay({ bufferSize: 1, refCount: false }),\n    );\n\n    this.httpsCallable = <T=any, R=any>(name: string) =>\n      (data: T) => from(functions).pipe(\n        observeOn(schedulers.outsideAngular),\n        switchMap(functions => functions.httpsCallable(name)(data)),\n        map(r => r.data as R)\n      )\n\n    return ɵlazySDKProxy(this, functions, zone);\n\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { AngularFireFunctions } from './functions';\n\n@NgModule({\n  providers: [ AngularFireFunctions ]\n})\nexport class AngularFireFunctionsModule { }\n"],"names":["InjectionToken","ɵAngularFireSchedulers","of","observeOn","switchMap","map","ɵfirebaseAppFactory","tap","shareReplay","from","ɵlazySDKProxy","Injectable","Inject","FIREBASE_OPTIONS","Optional","FIREBASE_APP_NAME","NgZone","NgModule"],"mappings":";;;;;;;;;;;QAOa,MAAM,GAAG,IAAIA,mBAAc,CAAS,+BAA+B;;QACnE,MAAM,GAAG,IAAIA,mBAAc,CAAS,+BAA+B;;IAG2B,CAAC;;QAS1G,8BAC4B,OAAuB,EACV,YAAoD,EAC3F,IAAY,EACgB,MAAkB,EAClB,MAAkB;;gBAExC,UAAU,GAAG,IAAIC,8BAAsB,CAAC,IAAI,CAAC;;gBAE7C,SAAS,GAAGC,OAAE,CAAC,SAAS,CAAC,CAAC,IAAI,CAClCC,mBAAS,CAAC,UAAU,CAAC,cAAc,CAAC,EACpCC,mBAAS;;;YAAC,cAAM,OAAA,OAAO,oBAAoB,CAAC,GAAA,EAAC,EAC7CC,aAAG;;;YAAC,cAAM,OAAAC,2BAAmB,CAAC,OAAO,EAAE,IAAI,EAAE,YAAY,CAAC,GAAA,EAAC,EAC3DD,aAAG;;;;YAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,SAAS,CAAC,MAAM,IAAI,SAAS,CAAC,GAAA,EAAC,EAC9CE,aAAG;;;;YAAC,UAAA,SAAS;gBACX,IAAI,MAAM,EAAE;oBAAE,SAAS,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAA;iBAAE;aACvD,EAAC,EACFC,qBAAW,CAAC,EAAE,UAAU,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAChD;YAED,IAAI,CAAC,aAAa;;;;;YAAG,UAAe,IAAY;;;;YAC9C,UAAC,IAAO,IAAK,OAAAC,SAAI,CAAC,SAAS,CAAC,CAAC,IAAI,CAC/BN,mBAAS,CAAC,UAAU,CAAC,cAAc,CAAC,EACpCC,mBAAS;;;;YAAC,UAAA,SAAS,IAAI,OAAA,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,GAAA,EAAC,EAC3DC,aAAG;;;;YAAC,UAAA,CAAC,8BAAI,CAAC,CAAC,IAAI,KAAK,EAAC,CACtB,GAAA,IAAA,CAAA,CAAA;YAEH,OAAOK,qBAAa,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;SAE7C;;oBApCFC,eAAU,SAAC;wBACV,UAAU,EAAE,KAAK;qBAClB;;;;oDAMIC,WAAM,SAACC,qBAAgB;oDACvBC,aAAQ,YAAIF,WAAM,SAACG,sBAAiB;oBAtBFC,WAAM;oDAwBxCF,aAAQ,YAAIF,WAAM,SAAC,MAAM;oDACzBE,aAAQ,YAAIF,WAAM,SAAC,MAAM;;;mCAzB9B;KAaA,IAsCC;;;QAjCC,6CAAyF;;;;;;;;QCf3F;SAG2C;;oBAH1CK,aAAQ,SAAC;wBACR,SAAS,EAAE,CAAE,oBAAoB,CAAE;qBACpC;;QACyC,iCAAC;KAH3C;;;;;;;;;;;;;;;"}